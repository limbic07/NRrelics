# NRrelic Bot v2.0.0

一款用于《艾尔登法环：黑夜君临》（Elden Ring Nightreign）的遗物自动化管理工具。不涉及任何游戏内数据修改，本质上不涉及作弊以及任何违反游戏规则的行为。

## 功能概览

### 商店筛选
- 自动在小壶商人处购买遗物（支持十连购买）
- OCR识别遗物词条，根据预设自动筛选
- 支持普通遗物和深夜遗物两种模式
- 支持新旧两个版本遗物切换
- 可设置暗痕停止阈值,低于阈值自动停止购买
- 双有效/三有效匹配模式切换

### 仓库清理
- 自动遍历遗物仪式仓库中的遗物
- 图像识别遗物状态（自由/已装备/已收藏/官方遗物）
- OCR识别词条，根据预设自动筛选
- 两种清理模式：售出模式 / 收藏模式
- 支持自动检测遗物数量或手动设置上限
- 双有效/三有效匹配模式切换

### 存档管理
- 自动检测Steam用户
- 存档备份与恢复
- 支持多个备份槽位管理

### 预设管理
- 通用预设：适用于所有遗物的词条白名单
- 专用预设：针对特定build的词条组合（最多20套）
- 黑名单预设：深夜模式下排除负面词条
- 词条库支持模糊匹配


## 使用说明

### 商店筛选
1. 配置词条预设（白名单/黑名单）
2. 选择游戏模式（普通/深夜）和遗物版本
3. 设置停止条件（暗痕数量或合格遗物目标）
4. 打开游戏商人界面
5. 点击"开始筛选"后回到游戏界面

### 仓库清理
1. 配置词条预设
2. 选择游戏模式（普通/深夜）和清理模式（售出/收藏）
3. 设置最大检测数量或自动检测仓库总数量
4. 打开游戏遗物仪式界面
5. 点击"开始清理"后回到游戏界面

### 存档管理
1. 设置Steam安装路径
2. 选择Steam用户
3. 创建备份 / 恢复备份

## 词条匹配规则

### 合格判定
1. 单正面词条 → 自动判定不合格
2. 黑名单词条匹配 → 不合格（仅深夜模式）
3. 白名单匹配：
   - 双有效模式：2条正面词条匹配 → 合格
   - 三有效模式：3条正面词条匹配 → 合格

### 预设优先级
通用预设 + 任一专用预设的组合匹配

## 技术特性

- **OCR引擎**：RapidOCR，支持中文识别
- **UI框架**：PySide6 + PySide6-Fluent-Widgets
- **图像处理**：OpenCV（模板匹配、边缘检测）
- **自动化**：pydirectinput / pyautogui

## 目录结构

```
NRrelics/
├── main.py              # 程序入口
├── core/                # 核心逻辑
│   ├── ocr_engine.py    # OCR引擎
│   ├── relic_detector.py # 遗物状态检测
│   ├── automation.py    # 仓库自动化
│   ├── shop_automation.py # 商店自动化
│   ├── repo_cleaner.py  # 仓库清理逻辑
│   ├── preset_manager.py # 预设管理
│   └── save_manager.py  # 存档管理
├── ui/                  # 用户界面
│   ├── main_window.py   # 主窗口
│   ├── pages/           # 功能页面
│   ├── dialogs/         # 对话框
│   └── components/      # UI组件
├── data/                # 数据资源
│   ├── normal.txt       # 普通模式词条库
│   ├── deepnight_pos.txt # 深夜模式正面词条库
│   └── deepnight_neg.txt # 深夜模式负面词条库
└── requirements.txt     # 依赖列表
```

## 注意事项
- 匹配规则为与 “通用预设 + 任一专用预设的组合” 匹配
- 仓库清理前强烈建议备份存档防止误删
- 用户数据（预设、设置、备份）保存在程序同级 `data/` 目录

